!function(){function t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t.map(function(t){return r(t)}),this.state=this.initialState.map(function(t){return r(t)}),this.score=0,this.status=e.STATUS_IDLE}return t=[{key:"moveLeft",value:function(){if(this.status===e.STATUS_PLAYING){for(var t=!1,r=0;r<4;r++){var n=this.slideAndMerge(this.state[r]);n.toString()!==this.state[r].toString()&&(t=!0),this.state[r]=n}t&&this.spawnTile(),this.checkLose(),this.checkWin()}}},{key:"moveRight",value:function(){this.state=this.state.map(function(t){return t.reverse()}),this.moveLeft(),this.state=this.state.map(function(t){return t.reverse()})}},{key:"moveUp",value:function(){this.transpose(),this.moveLeft(),this.transpose()}},{key:"moveDown",value:function(){this.transpose(),this.moveRight(),this.transpose()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state.map(function(t){return r(t)})}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=e.STATUS_PLAYING,this.spawnTile(),this.spawnTile(),this.checkWin(),this.checkLose()}},{key:"restart",value:function(){this.state=this.initialState.map(function(t){return r(t)}),this.score=0,this.status=e.STATUS_IDLE}},{key:"spawnTile",value:function(){for(var t=[],e=0;e<4;e++)for(var r=0;r<4;r++)0===this.state[e][r]&&t.push({row:e,column:r});if(t.length>0){var n=t[Math.floor(Math.random()*t.length)],a=n.row,i=n.column;this.state[a][i]=.9>Math.random()?2:4}}},{key:"transpose",value:function(){for(var t=this.initialState.map(function(t){return r(t)}),e=0;e<4;e++)for(var n=0;n<4;n++)t[n][e]=this.state[e][n];this.state=t}},{key:"slideAndMerge",value:function(t){for(var e=t.filter(function(t){return 0!==t}),r=0;r<e.length-1;r++)e[r]===e[r+1]&&(e[r]*=2,this.score+=e[r],e[r+1]=0);for(e=e.filter(function(t){return 0!==t});4!==e.length;)e.push(0);return e}},{key:"checkWin",value:function(){for(var t=0;t<4;t++)for(var r=0;r<4;r++)this.state[t][r]===e.WINNING_TILE&&(this.status=e.STATUS_WIN)}},{key:"checkLose",value:function(){for(var t=0;t<4;t++)for(var r=0;r<4;r++)if(0===this.state[t][r])return;for(var n=0;n<4;n++)for(var a=0;a<4;a++)if(n<3&&this.state[n][a]===this.state[n+1][a]||a<3&&this.state[n][a]===this.state[n][a+1])return;this.status=e.STATUS_LOSE}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}();t(n,"STATUS_IDLE","idle"),t(n,"STATUS_PLAYING","playing"),t(n,"STATUS_WIN","win"),t(n,"STATUS_LOSE","lose"),t(n,"WINNING_TILE",2048);var a=new n,i=document.querySelector(".start"),s=!1;function o(t,e,r){i.classList.replace(e,r),i.textContent=t}function c(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;document.querySelectorAll(".message").forEach(function(t){t.classList.toggle("hidden",!0)}),(t=e?document.querySelector(".message-".concat(e)):document.querySelector(".message-".concat(a.getStatus())))&&t.classList.toggle("hidden",!1)}function u(t){var e=document.querySelectorAll(".field-row");document.querySelector(".game-score").textContent=a.getScore();for(var r=0;r<4;r++)for(var n=0;n<4;n++){var i=e[r].children[n];0!==t[r][n]?(i.textContent=t[r][n],i.className=i.className.replace(/field-cell--\d+/g,""),i.classList.add("field-cell--".concat(t[r][n]))):(i.textContent="",i.className=i.className.replace(/field-cell--\d+/g,""),i.className="field-cell")}}i.addEventListener("click",function(t){t.target&&((s=!s)?(o("Retart","start","restart"),c(),a.start()):(o("Start","restart","start"),c("start"),a.restart()),u(a.getState()))}),document.addEventListener("keydown",function(t){if(s){switch(t.preventDefault(),t.key){case"ArrowUp":a.moveUp();break;case"ArrowDown":a.moveDown();break;case"ArrowRight":a.moveRight();break;case"ArrowLeft":a.moveLeft()}c(),u(a.getState())}})}();
//# sourceMappingURL=index.dca28d03.js.map
